# Docker 및 Docker Compose Best Practices

## Docker 일반 Best Practices

- **최신 공식 이미지를 사용**: 신뢰할 수 있는 공식 이미지를 사용하고, 항상 태그를 명시적으로 지정합니다.
- **이미지 크기 최소화**: 불필요한 패키지와 파일을 제거하여 이미지 크기를 줄입니다. `alpine` 기반 이미지를 고려하세요.
- **멀티스테이지 빌드 활용**: 빌드와 런타임 이미지를 분리하여 최적화합니다.
- **캐시 활용**: Dockerfile의 명령 순서를 최적화하여 빌드 캐시를 최대한 활용합니다.
- **환경 변수 관리**: 민감 정보는 환경 변수로 관리하고, 코드에 직접 포함하지 않습니다.
- **적절한 USER 지정**: 컨테이너 내에서 root가 아닌 일반 사용자로 실행합니다.
- **헬스체크 추가**: `HEALTHCHECK`를 활용해 컨테이너의 상태를 모니터링합니다.
- **불필요한 포트/볼륨 노출 금지**: 필요한 포트와 볼륨만 노출합니다.
- **로그 관리**: 로그는 표준 출력/에러로 남기고, 외부 로그 수집 시스템과 연동합니다.

## Docker Compose Best Practices

- **버전 명시**: `version` 필드를 명확히 지정합니다.
- **환경 변수 파일 사용**: `.env` 파일을 활용해 환경별 설정을 분리합니다.
- **의존성 명확히**: `depends_on`을 활용해 서비스 간 의존성을 명확히 합니다.
- **볼륨/네트워크 분리**: 서비스별로 볼륨과 네트워크를 분리해 관리합니다.
- **리소스 제한 설정**: `mem_limit`, `cpus` 등 리소스 제한을 설정해 과도한 사용을 방지합니다.
- **보안 설정**: 민감 정보는 환경 변수 또는 secret 관리 기능을 활용합니다.
- **빌드 컨텍스트 최소화**: 빌드 컨텍스트에 불필요한 파일이 포함되지 않도록 `.dockerignore`를 활용합니다.
- **서비스 이름 명확히**: 서비스 이름은 역할이 명확하게 드러나도록 지정합니다.
- **테스트 환경 분리**: 개발/테스트/운영 환경별로 compose 파일을 분리하거나 override 파일을 사용합니다.

---
이 규칙들은 Docker 및 Docker Compose를 활용한 컨테이너 기반 개발 및 운영 환경에서 신뢰성과 보안, 유지보수성을 높이기 위한 권장 사항입니다.
